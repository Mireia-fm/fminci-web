# üöÄ Roadmap para Producci√≥n - FMINCI Web

**Fecha de creaci√≥n:** 2025-10-02
**Versi√≥n actual:** Pre-producci√≥n
**Estado:** Listo para Fase 3 y optimizaciones finales

---

## üìã √çndice

1. [Estado Actual del Proyecto](#estado-actual-del-proyecto)
2. [Mejoras Completadas](#mejoras-completadas)
3. [Fase 3: Centralizaci√≥n de Servicios](#fase-3-centralizaci√≥n-de-servicios)
4. [Fase 4: Refactorizaci√≥n de Chat Proveedor](#fase-4-refactorizaci√≥n-de-chat-proveedor)
5. [Mejoras Cr√≠ticas para Producci√≥n](#mejoras-cr√≠ticas-para-producci√≥n)
6. [Mejoras Recomendadas](#mejoras-recomendadas)
7. [Optimizaciones de Performance](#optimizaciones-de-performance)
8. [Checklist Pre-Producci√≥n](#checklist-pre-producci√≥n)

---

## üìä Estado Actual del Proyecto

### ‚úÖ Completado (Fases 1 y 2)

#### Fase 1: Centralizaci√≥n de Queries y Theming
**Objetivo:** Eliminar duplicaci√≥n de c√≥digo y centralizar l√≥gica com√∫n

**Archivos creados:**
- ‚úÖ `contexts/AuthContext.tsx` - Manejo centralizado de autenticaci√≥n
- ‚úÖ `lib/incidenciasService.ts` - Queries de incidencias centralizadas
- ‚úÖ `lib/theme.ts` - Colores y constantes centralizadas

**Refactorizaciones:**
- ‚úÖ `components/DashboardProveedor.tsx` - 383 ‚Üí 273 l√≠neas (-28%)
- ‚úÖ `components/DashboardCliente.tsx` - 437 ‚Üí 280 l√≠neas (-36%)
- ‚úÖ **Fix N+1 query** en DashboardCliente para gestores

**Impacto:**
- üî• ~150 l√≠neas de c√≥digo eliminadas
- üî• PALETA unificada en 13 archivos
- üî• Queries optimizadas (reducci√≥n de N queries a 1)

#### Fase 2: Aplicaci√≥n de useAuth()
**Objetivo:** Usar AuthContext en todos los componentes

**Archivos refactorizados:**
- ‚úÖ `app/(app)/incidencias/page.tsx` - Eliminadas ~60 l√≠neas
- ‚úÖ `app/(app)/incidencias/nueva/page.tsx` - Simplificado
- ‚úÖ `app/(app)/control/page.tsx` - 143 ‚Üí 102 l√≠neas (-29%)
- ‚úÖ `app/(app)/calendario/page.tsx` - Queries eliminadas

**Impacto:**
- üî• ~200 l√≠neas adicionales eliminadas
- üî• Auth completamente centralizado
- üî• Cero verificaciones manuales de rol en componentes

#### Migraci√≥n de Seguridad: Roles Nativos PostgreSQL
**Objetivo:** Implementar seguridad real a nivel de base de datos

**Logros:**
- ‚úÖ 7 migraciones aplicadas exitosamente
- ‚úÖ 26 pol√≠ticas RLS nuevas creadas
- ‚úÖ 100% de tablas con RLS habilitado
- ‚úÖ 0 errores de seguridad (antes: 5 ERROR)
- ‚úÖ Trigger autom√°tico de sincronizaci√≥n
- ‚úÖ Funciones SECURITY DEFINER protegidas

**Documentaci√≥n:**
- üìÑ [MIGRACION_ROLES_NATIVOS.md](MIGRACION_ROLES_NATIVOS.md) - Informe completo

### üìà M√©tricas de Mejora

| M√©trica | Antes | Despu√©s | Mejora |
|---------|-------|---------|--------|
| L√≠neas de c√≥digo duplicado | ~350 | 0 | ‚úÖ -100% |
| Archivos con PALETA local | 13 | 0 | ‚úÖ -100% |
| Tablas sin RLS | 10 | 0 | ‚úÖ -100% |
| Errores de seguridad | 5 | 0 | ‚úÖ -100% |
| N+1 queries | 1 | 0 | ‚úÖ -100% |
| Build time | ~13s | ~12s | ‚úÖ -8% |

---

## üéØ Fase 3: Centralizaci√≥n de Servicios

**Estado:** üî¥ PENDIENTE
**Prioridad:** üî• ALTA (requerido antes de producci√≥n)
**Tiempo estimado:** 4-6 horas

### Objetivo

Eliminar queries duplicadas de comentarios y presupuestos, actualmente esparcidas en m√∫ltiples archivos.

### 3.1 Crear `lib/comentariosService.ts`

**Archivos afectados:**
- `app/(app)/incidencias/[id]/chat-control-cliente/page.tsx` (1,200 l√≠neas)
- `app/(app)/incidencias/[id]/chat-proveedor/page.tsx` (3,843 l√≠neas)

**Funciones a crear:**

```typescript
// lib/comentariosService.ts

import { supabase } from "./supabaseClient";
import { Perfil } from "@/contexts/AuthContext";

export type Comentario = {
  id: string;
  incidencia_id: string;
  ambito: "cliente" | "proveedor" | "ambos";
  proveedor_id?: string;
  autor_id?: string;
  autor_email?: string;
  autor_rol?: string;
  es_sistema: boolean;
  cuerpo?: string;
  imagen_url?: string;
  documento_url?: string;
  creado_en: string;
};

/**
 * Obtener todos los comentarios de una incidencia
 * Filtra autom√°ticamente por √°mbito seg√∫n el rol del usuario
 */
export async function obtenerComentarios(
  incidenciaId: string,
  perfil: Perfil,
  proveedorId?: string
): Promise<Comentario[]> {
  // Implementar l√≥gica seg√∫n rol:
  // - Control: ve todos los comentarios
  // - Proveedor: ve solo √°mbito "proveedor" y "ambos" de su proveedor
  // - Cliente/Gestor: ve solo √°mbito "cliente" y "ambos"
}

/**
 * Crear un nuevo comentario
 */
export async function crearComentario(
  data: {
    incidencia_id: string;
    ambito: "cliente" | "proveedor" | "ambos";
    proveedor_id?: string;
    cuerpo?: string;
    imagen_url?: string;
    documento_url?: string;
  },
  perfil: Perfil
): Promise<{ data: Comentario | null; error: any }> {
  // Agregar autor_id, autor_email, autor_rol autom√°ticamente
  // Validar permisos seg√∫n rol
}

/**
 * Actualizar un comentario existente
 * Solo Control puede actualizar
 */
export async function actualizarComentario(
  comentarioId: string,
  updates: Partial<Comentario>,
  perfil: Perfil
): Promise<{ data: Comentario | null; error: any }> {
  if (perfil.rol !== "Control") {
    return { data: null, error: { message: "No autorizado" } };
  }
  // Implementar actualizaci√≥n
}

/**
 * Eliminar un comentario
 * Solo Control puede eliminar
 */
export async function eliminarComentario(
  comentarioId: string,
  perfil: Perfil
): Promise<{ error: any }> {
  if (perfil.rol !== "Control") {
    return { error: { message: "No autorizado" } };
  }
  // Implementar eliminaci√≥n
}

/**
 * Subir imagen para comentario
 */
export async function subirImagenComentario(
  file: File,
  incidenciaId: string
): Promise<{ url: string | null; error: any }> {
  // Implementar upload a Supabase Storage
  // Bucket: comentarios-imagenes
  // Path: {incidenciaId}/{timestamp}-{filename}
}

/**
 * Subir documento para comentario
 */
export async function subirDocumentoComentario(
  file: File,
  incidenciaId: string
): Promise<{ url: string | null; error: any }> {
  // Implementar upload a Supabase Storage
  // Bucket: comentarios-documentos
  // Path: {incidenciaId}/{timestamp}-{filename}
}

/**
 * Obtener URL firmada de imagen
 */
export async function obtenerUrlFirmadaImagen(
  path: string
): Promise<string | null> {
  // Implementar obtenci√≥n de signed URL
  // Duraci√≥n: 3600 segundos (1 hora)
}

/**
 * Obtener URL firmada de documento
 */
export async function obtenerUrlFirmadaDocumento(
  path: string
): Promise<string | null> {
  // Implementar obtenci√≥n de signed URL
  // Duraci√≥n: 3600 segundos (1 hora)
}
```

**Pasos de implementaci√≥n:**

1. ‚úÖ Crear archivo `lib/comentariosService.ts`
2. ‚úÖ Implementar funci√≥n `obtenerComentarios()`
3. ‚úÖ Implementar funci√≥n `crearComentario()`
4. ‚úÖ Implementar funciones de upload (imagen/documento)
5. ‚úÖ Implementar funciones de URLs firmadas
6. ‚úÖ Refactorizar `chat-control-cliente/page.tsx` para usar el servicio
7. ‚úÖ Refactorizar `chat-proveedor/page.tsx` para usar el servicio
8. ‚úÖ Probar creaci√≥n, lectura, y visualizaci√≥n de comentarios
9. ‚úÖ Verificar permisos por rol

**Reducci√≥n esperada:**
- `chat-control-cliente/page.tsx`: 1,200 ‚Üí ~900 l√≠neas (-25%)
- `chat-proveedor/page.tsx`: 3,843 ‚Üí ~3,200 l√≠neas (-17%)
- **Total:** ~640 l√≠neas eliminadas

---

### 3.2 Crear `lib/presupuestosService.ts`

**Archivos afectados:**
- `app/(app)/incidencias/[id]/chat-proveedor/page.tsx` (3,843 l√≠neas)
- `app/(app)/control/presupuestos/page.tsx` (300 l√≠neas)

**Funciones a crear:**

```typescript
// lib/presupuestosService.ts

import { supabase } from "./supabaseClient";
import { Perfil } from "@/contexts/AuthContext";

export type Presupuesto = {
  id: string;
  incidencia_id: string;
  proveedor_id: string;
  numero_incidencia: string;
  fecha_estimada_inicio: string;
  duracion_estimada: string;
  importe_total_sin_iva: number;
  presupuesto_detallado_url?: string;
  descripcion_breve: string;
  estado: "pendiente_revision" | "aprobado" | "rechazado";
  creado_por?: string;
  revisado_por?: string;
  revisado_en?: string;
  comentarios_revision?: string;
  creado_en: string;
};

/**
 * Obtener presupuestos de una incidencia
 */
export async function obtenerPresupuestos(
  incidenciaId: string,
  perfil: Perfil
): Promise<Presupuesto[]> {
  // Control: ve todos
  // Proveedor: solo los de su proveedor
  // Cliente/Gestor: todos los de la incidencia (RLS filtra)
}

/**
 * Obtener un presupuesto espec√≠fico
 */
export async function obtenerPresupuesto(
  presupuestoId: string,
  perfil: Perfil
): Promise<Presupuesto | null> {
  // Validar permisos seg√∫n rol
}

/**
 * Crear un nuevo presupuesto
 */
export async function crearPresupuesto(
  data: {
    incidencia_id: string;
    proveedor_id: string;
    numero_incidencia: string;
    fecha_estimada_inicio: string;
    duracion_estimada: string;
    importe_total_sin_iva: number;
    descripcion_breve: string;
    presupuesto_detallado_file?: File;
  },
  perfil: Perfil
): Promise<{ data: Presupuesto | null; error: any }> {
  // 1. Validar que el usuario es proveedor del proveedor_id
  // 2. Subir archivo PDF si existe
  // 3. Crear presupuesto en BD
  // 4. Agregar creado_por autom√°ticamente
}

/**
 * Actualizar estado del presupuesto (aprobar/rechazar)
 * Solo Control puede hacerlo
 */
export async function actualizarEstadoPresupuesto(
  presupuestoId: string,
  estado: "aprobado" | "rechazado",
  comentarios_revision?: string,
  perfil: Perfil
): Promise<{ data: Presupuesto | null; error: any }> {
  if (perfil.rol !== "Control") {
    return { data: null, error: { message: "No autorizado" } };
  }
  // Actualizar estado, revisado_por, revisado_en, comentarios_revision
}

/**
 * Subir documento de presupuesto detallado (PDF)
 */
export async function subirDocumentoPresupuesto(
  file: File,
  incidenciaId: string,
  proveedorId: string
): Promise<{ url: string | null; error: any }> {
  // Bucket: presupuestos
  // Path: {incidenciaId}/{proveedorId}/{timestamp}-{filename}
  // Validar que sea PDF
}

/**
 * Obtener URL firmada del documento de presupuesto
 */
export async function obtenerUrlPresupuesto(
  path: string
): Promise<string | null> {
  // Duraci√≥n: 7200 segundos (2 horas)
}

/**
 * Obtener todos los presupuestos pendientes de revisi√≥n
 * Solo para Control
 */
export async function obtenerPresupuestosPendientes(
  perfil: Perfil
): Promise<Presupuesto[]> {
  if (perfil.rol !== "Control") {
    return [];
  }
  // Query con .eq("estado", "pendiente_revision")
}

/**
 * Obtener estad√≠sticas de presupuestos
 * Solo para Control
 */
export async function obtenerEstadisticasPresupuestos(
  perfil: Perfil
): Promise<{
  total: number;
  pendientes: number;
  aprobados: number;
  rechazados: number;
  importe_total_aprobado: number;
}> {
  if (perfil.rol !== "Control") {
    return { total: 0, pendientes: 0, aprobados: 0, rechazados: 0, importe_total_aprobado: 0 };
  }
  // Implementar agregaciones
}
```

**Pasos de implementaci√≥n:**

1. ‚úÖ Crear archivo `lib/presupuestosService.ts`
2. ‚úÖ Implementar funci√≥n `obtenerPresupuestos()`
3. ‚úÖ Implementar funci√≥n `crearPresupuesto()` con upload
4. ‚úÖ Implementar funci√≥n `actualizarEstadoPresupuesto()`
5. ‚úÖ Implementar funci√≥n `obtenerPresupuestosPendientes()`
6. ‚úÖ Refactorizar `chat-proveedor/page.tsx` para usar el servicio
7. ‚úÖ Refactorizar `control/presupuestos/page.tsx` para usar el servicio
8. ‚úÖ Probar creaci√≥n, aprobaci√≥n/rechazo
9. ‚úÖ Verificar permisos por rol

**Reducci√≥n esperada:**
- `chat-proveedor/page.tsx`: 3,200 ‚Üí ~2,800 l√≠neas (-12%)
- `control/presupuestos/page.tsx`: 300 ‚Üí ~200 l√≠neas (-33%)
- **Total:** ~500 l√≠neas eliminadas

---

### 3.3 Testing de la Fase 3

**Tests requeridos:**

```bash
# Build debe pasar
npm run build

# Tests funcionales manuales:
1. Login como Control ‚Üí Ver todos los comentarios
2. Login como Proveedor ‚Üí Solo ver comentarios de proveedor
3. Login como Cliente ‚Üí Solo ver comentarios de cliente
4. Crear comentario con imagen
5. Crear comentario con documento
6. Crear presupuesto como Proveedor
7. Aprobar presupuesto como Control
8. Rechazar presupuesto como Control
```

**Checklist:**
- [ ] Build exitoso sin errores
- [ ] Comentarios se crean correctamente
- [ ] Im√°genes se suben y visualizan
- [ ] Documentos se suben y descargan
- [ ] Presupuestos se crean correctamente
- [ ] Solo Control puede aprobar/rechazar
- [ ] RLS previene acceso no autorizado

---

## üîß Fase 4: Refactorizaci√≥n de Chat Proveedor

**Estado:** üî¥ PENDIENTE
**Prioridad:** üü° MEDIA (mejora de mantenibilidad)
**Tiempo estimado:** 6-8 horas

### Objetivo

Dividir `chat-proveedor/page.tsx` (actualmente 3,843 l√≠neas) en componentes modulares m√°s peque√±os y mantenibles.

### An√°lisis del Archivo Actual

**Estructura detectada:**
```typescript
// chat-proveedor/page.tsx (3,843 l√≠neas)
‚îú‚îÄ‚îÄ Estados (54 useState) - L√≠neas 1-150
‚îú‚îÄ‚îÄ useEffects (8) - L√≠neas 150-350
‚îú‚îÄ‚îÄ Funciones helper (20+) - L√≠neas 350-1500
‚îÇ   ‚îú‚îÄ‚îÄ cargarDatos()
‚îÇ   ‚îú‚îÄ‚îÄ cargarComentarios()
‚îÇ   ‚îú‚îÄ‚îÄ enviarComentario()
‚îÇ   ‚îú‚îÄ‚îÄ subirImagen()
‚îÇ   ‚îú‚îÄ‚îÄ manejarPresupuesto()
‚îÇ   ‚îú‚îÄ‚îÄ actualizarEstado()
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ JSX (2,300 l√≠neas) - L√≠neas 1500-3843
    ‚îú‚îÄ‚îÄ Header con informaci√≥n de incidencia
    ‚îú‚îÄ‚îÄ Timeline de comentarios
    ‚îú‚îÄ‚îÄ Secci√≥n de presupuestos
    ‚îú‚îÄ‚îÄ Formulario de comentarios
    ‚îú‚îÄ‚îÄ Secci√≥n de cambio de estado
    ‚îú‚îÄ‚îÄ Secci√≥n de fecha de visita
    ‚îî‚îÄ‚îÄ Di√°logos modales
```

### 4.1 Estructura Propuesta

Dividir en 8 componentes especializados:

```
app/(app)/incidencias/[id]/chat-proveedor/
‚îú‚îÄ‚îÄ page.tsx (500 l√≠neas) - Orchestrator principal
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ ChatProveedorHeader.tsx (150 l√≠neas)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Informaci√≥n de incidencia
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Estado actual
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Acciones r√°pidas
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ TimelineComentarios.tsx (400 l√≠neas)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Lista de comentarios
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Scroll autom√°tico
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Filtros por √°mbito
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ FormularioComentario.tsx (300 l√≠neas)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Input de texto
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Upload de imagen
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Upload de documento
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Selector de √°mbito
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ SeccionPresupuestos.tsx (500 l√≠neas)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Lista de presupuestos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Formulario de nuevo presupuesto
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Estado de presupuestos
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ SeccionEstado.tsx (300 l√≠neas)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Selector de estado
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Motivo/comentario
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Confirmaci√≥n
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ SeccionFechaVisita.tsx (250 l√≠neas)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Calendario
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Selector de horario
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Confirmaci√≥n
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ DialogoImagen.tsx (150 l√≠neas)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Modal para visualizar im√°genes
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ DialogoDocumento.tsx (150 l√≠neas)
‚îÇ       ‚îî‚îÄ‚îÄ Modal para visualizar documentos
‚îÇ
‚îî‚îÄ‚îÄ hooks/
    ‚îú‚îÄ‚îÄ useChatProveedor.ts (400 l√≠neas)
    ‚îÇ   ‚îú‚îÄ‚îÄ Estado compartido
    ‚îÇ   ‚îú‚îÄ‚îÄ L√≥gica de comentarios
    ‚îÇ   ‚îî‚îÄ‚îÄ L√≥gica de presupuestos
    ‚îÇ
    ‚îî‚îÄ‚îÄ useIncidenciaData.ts (200 l√≠neas)
        ‚îú‚îÄ‚îÄ Carga de datos iniciales
        ‚îî‚îÄ‚îÄ Actualizaci√≥n de datos
```

### 4.2 Pasos de Implementaci√≥n

#### Paso 1: Crear Hook Principal (2 horas)

```typescript
// hooks/useChatProveedor.ts

export function useChatProveedor(incidenciaId: string) {
  const { perfil, proveedorId } = useAuth();
  const [comentarios, setComentarios] = useState<Comentario[]>([]);
  const [presupuestos, setPresupuestos] = useState<Presupuesto[]>([]);
  const [loading, setLoading] = useState(true);

  const cargarDatos = async () => {
    // Centralizar toda la l√≥gica de carga
  };

  const agregarComentario = async (data: NuevoComentario) => {
    // Usar comentariosService
  };

  const crearPresupuesto = async (data: NuevoPresupuesto) => {
    // Usar presupuestosService
  };

  return {
    comentarios,
    presupuestos,
    loading,
    agregarComentario,
    crearPresupuesto,
    cargarDatos,
  };
}
```

#### Paso 2: Extraer Componentes (4 horas)

**Prioridad de extracci√≥n:**

1. ‚úÖ `ChatProveedorHeader.tsx` - M√°s simple, bajo acoplamiento
2. ‚úÖ `DialogoImagen.tsx` y `DialogoDocumento.tsx` - Independientes
3. ‚úÖ `FormularioComentario.tsx` - Usa el hook
4. ‚úÖ `TimelineComentarios.tsx` - Usa el hook
5. ‚úÖ `SeccionPresupuestos.tsx` - Usa presupuestosService
6. ‚úÖ `SeccionEstado.tsx` - L√≥gica espec√≠fica
7. ‚úÖ `SeccionFechaVisita.tsx` - L√≥gica espec√≠fica

#### Paso 3: Refactorizar page.tsx (2 horas)

```typescript
// page.tsx (objetivo: ~500 l√≠neas)

export default function ChatProveedorPage({ params }: Props) {
  const incidenciaId = params.id;
  const chatData = useChatProveedor(incidenciaId);
  const incidenciaData = useIncidenciaData(incidenciaId);

  if (chatData.loading) return <LoadingSpinner />;

  return (
    <div className="chat-proveedor">
      <ChatProveedorHeader incidencia={incidenciaData.incidencia} />

      <TimelineComentarios
        comentarios={chatData.comentarios}
        onNuevoComentario={chatData.agregarComentario}
      />

      <FormularioComentario
        onEnviar={chatData.agregarComentario}
      />

      <SeccionPresupuestos
        presupuestos={chatData.presupuestos}
        onCrear={chatData.crearPresupuesto}
      />

      <SeccionEstado
        incidenciaId={incidenciaId}
        estadoActual={incidenciaData.estado}
        onCambiarEstado={incidenciaData.actualizarEstado}
      />

      <SeccionFechaVisita
        incidenciaId={incidenciaId}
        fechaActual={incidenciaData.fechaVisita}
      />
    </div>
  );
}
```

### 4.3 Testing de la Fase 4

**Tests requeridos:**

```bash
# Build debe pasar
npm run build

# Tests funcionales:
1. Cargar chat-proveedor ‚Üí Ver todos los comentarios
2. Enviar nuevo comentario ‚Üí Aparece en timeline
3. Subir imagen ‚Üí Se visualiza correctamente
4. Crear presupuesto ‚Üí Aparece en lista
5. Cambiar estado ‚Üí Se actualiza en BD
6. Calendarizar visita ‚Üí Se guarda correctamente
```

**Checklist:**
- [ ] Build exitoso sin errores
- [ ] Todos los componentes funcionan aisladamente
- [ ] Hook useChatProveedor funciona correctamente
- [ ] No hay regresiones en funcionalidad
- [ ] Tama√±o de archivo reducido significativamente

---

## üö® Mejoras Cr√≠ticas para Producci√≥n

**Prioridad:** üî• CR√çTICA (debe completarse antes de producci√≥n)

### 1. Variables de Entorno y Configuraci√≥n

**Estado:** üî¥ PENDIENTE

**Problemas actuales:**
- `.env.local` contiene credenciales reales
- No hay `.env.example` documentado
- Falta validaci√≥n de variables de entorno

**Tareas:**

```bash
# 1. Crear .env.example
cat > .env.example << 'EOF'
# Supabase Configuration
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# App Configuration
NEXT_PUBLIC_APP_URL=http://localhost:3000
NODE_ENV=development
EOF

# 2. Actualizar .gitignore
echo ".env.local" >> .gitignore
echo ".env.production" >> .gitignore
```

```typescript
// lib/env.ts - Validaci√≥n de variables de entorno
const requiredEnvVars = [
  'NEXT_PUBLIC_SUPABASE_URL',
  'NEXT_PUBLIC_SUPABASE_ANON_KEY',
] as const;

export function validateEnv() {
  const missing = requiredEnvVars.filter(
    (key) => !process.env[key]
  );

  if (missing.length > 0) {
    throw new Error(
      `Missing required environment variables: ${missing.join(', ')}`
    );
  }
}

// Llamar en app/layout.tsx
validateEnv();
```

**Checklist:**
- [ ] Crear `.env.example` con documentaci√≥n
- [ ] Crear `lib/env.ts` con validaci√≥n
- [ ] Verificar que `.env.local` no est√° en git
- [ ] Documentar variables en README.md

---

### 2. Manejo de Errores Global

**Estado:** üü° PARCIAL (hay algunos try-catch pero no hay manejo global)

**Problemas actuales:**
- No hay boundary de errores en React
- Errores de Supabase no se manejan consistentemente
- No hay logging de errores en producci√≥n

**Tareas:**

```typescript
// components/ErrorBoundary.tsx
'use client';

import { Component, ReactNode } from 'react';

interface Props {
  children: ReactNode;
  fallback?: ReactNode;
}

interface State {
  hasError: boolean;
  error?: Error;
}

export class ErrorBoundary extends Component<Props, State> {
  constructor(props: Props) {
    super(props);
    this.state = { hasError: false };
  }

  static getDerivedStateFromError(error: Error): State {
    return { hasError: true, error };
  }

  componentDidCatch(error: Error, errorInfo: any) {
    // Enviar a servicio de logging (ej: Sentry, LogRocket)
    console.error('Error capturado por boundary:', error, errorInfo);

    // En producci√≥n, enviar a tu backend o servicio de logs
    if (process.env.NODE_ENV === 'production') {
      // fetch('/api/log-error', { ... })
    }
  }

  render() {
    if (this.state.hasError) {
      return this.props.fallback || (
        <div className="error-container">
          <h2>Algo sali√≥ mal</h2>
          <p>Por favor, recarga la p√°gina o contacta a soporte.</p>
          <button onClick={() => window.location.reload()}>
            Recargar
          </button>
        </div>
      );
    }

    return this.props.children;
  }
}
```

```typescript
// app/layout.tsx - Agregar ErrorBoundary
import { ErrorBoundary } from '@/components/ErrorBoundary';

export default function RootLayout({ children }) {
  return (
    <html lang="es">
      <body>
        <ErrorBoundary>
          <AuthProvider>
            {children}
          </AuthProvider>
        </ErrorBoundary>
      </body>
    </html>
  );
}
```

```typescript
// lib/errorHandler.ts - Helper para errores de Supabase
export function handleSupabaseError(error: any, context?: string) {
  console.error(`Error en ${context || 'operaci√≥n'}:`, error);

  // Mensajes amigables para el usuario
  const userMessage = error.message || 'Ocurri√≥ un error inesperado';

  // En producci√≥n, enviar a logging service
  if (process.env.NODE_ENV === 'production') {
    // logToService(error, context);
  }

  return userMessage;
}

// Uso en servicios:
export async function obtenerIncidencias() {
  try {
    const { data, error } = await supabase.from('incidencias').select();
    if (error) throw error;
    return data;
  } catch (error) {
    throw new Error(handleSupabaseError(error, 'obtenerIncidencias'));
  }
}
```

**Checklist:**
- [ ] Crear `ErrorBoundary` component
- [ ] Agregar ErrorBoundary en layout principal
- [ ] Crear `lib/errorHandler.ts`
- [ ] Actualizar todos los servicios para usar errorHandler
- [ ] Configurar logging service (opcional: Sentry)

---

### 3. Loading States y UX

**Estado:** üü° PARCIAL (algunos componentes tienen loading, otros no)

**Problemas actuales:**
- No hay loading state consistente
- No hay skeleton loaders
- Transiciones abruptas

**Tareas:**

```typescript
// components/LoadingSpinner.tsx
export function LoadingSpinner({ size = 'md' }: { size?: 'sm' | 'md' | 'lg' }) {
  const sizeClasses = {
    sm: 'w-4 h-4',
    md: 'w-8 h-8',
    lg: 'w-12 h-12',
  };

  return (
    <div className="flex items-center justify-center">
      <div className={`${sizeClasses[size]} border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin`} />
    </div>
  );
}

// components/SkeletonCard.tsx
export function SkeletonCard() {
  return (
    <div className="animate-pulse bg-gray-200 rounded-lg p-4">
      <div className="h-4 bg-gray-300 rounded w-3/4 mb-2"></div>
      <div className="h-4 bg-gray-300 rounded w-1/2"></div>
    </div>
  );
}
```

**Patr√≥n recomendado:**

```typescript
// Antes:
export default function Dashboard() {
  const [data, setData] = useState([]);

  useEffect(() => {
    cargarDatos();
  }, []);

  return <div>{data.map(...)}</div>; // ‚ùå Flash de contenido vac√≠o
}

// Despu√©s:
export default function Dashboard() {
  const [data, setData] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    cargarDatos().finally(() => setLoading(false));
  }, []);

  if (loading) return <SkeletonCard />; // ‚úÖ Skeleton mientras carga

  return <div>{data.map(...)}</div>;
}
```

**Checklist:**
- [ ] Crear componentes de loading (Spinner, Skeleton)
- [ ] Agregar loading states a todos los useEffect
- [ ] Usar Suspense donde sea apropiado (Next.js 15)
- [ ] Agregar transiciones suaves (Framer Motion opcional)

---

### 4. Validaci√≥n de Formularios

**Estado:** üü° PARCIAL (hay validaciones b√°sicas)

**Problemas actuales:**
- Validaciones inconsistentes
- Mensajes de error no estandarizados
- No hay validaci√≥n de tipos de archivo

**Tareas:**

```bash
# Instalar biblioteca de validaci√≥n
npm install zod react-hook-form @hookform/resolvers
```

```typescript
// lib/schemas/incidenciaSchema.ts
import { z } from 'zod';

export const nuevaIncidenciaSchema = z.object({
  fecha: z.string().min(1, 'Fecha es requerida'),
  hora: z.string().min(1, 'Hora es requerida'),
  nombre_solicitante: z.string().min(2, 'Nombre debe tener al menos 2 caracteres'),
  email: z.string().email('Email inv√°lido'),
  centro: z.string().uuid('Centro es requerido'),
  prioridad: z.enum(['Urgente', 'Critico', 'Normal']),
  catalogacion: z.string().min(1, 'Catalogaci√≥n es requerida'),
  descripcion: z.string().min(10, 'Descripci√≥n debe tener al menos 10 caracteres'),
  imagen: z.instanceof(File).optional().refine(
    (file) => !file || file.size <= 5 * 1024 * 1024,
    'La imagen debe ser menor a 5MB'
  ).refine(
    (file) => !file || ['image/jpeg', 'image/png', 'image/webp'].includes(file.type),
    'Solo se permiten im√°genes JPG, PNG o WebP'
  ),
});

export type NuevaIncidenciaInput = z.infer<typeof nuevaIncidenciaSchema>;
```

```typescript
// Uso en formulario con react-hook-form
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';

export default function NuevaIncidenciaForm() {
  const {
    register,
    handleSubmit,
    formState: { errors },
  } = useForm<NuevaIncidenciaInput>({
    resolver: zodResolver(nuevaIncidenciaSchema),
  });

  const onSubmit = async (data: NuevaIncidenciaInput) => {
    // Data est√° validada autom√°ticamente
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)}>
      <input {...register('nombre_solicitante')} />
      {errors.nombre_solicitante && (
        <span className="error">{errors.nombre_solicitante.message}</span>
      )}
    </form>
  );
}
```

**Schemas a crear:**
- [ ] `incidenciaSchema.ts` - Nueva incidencia
- [ ] `comentarioSchema.ts` - Nuevo comentario
- [ ] `presupuestoSchema.ts` - Nuevo presupuesto
- [ ] `loginSchema.ts` - Login form

---

### 5. Seguridad: Storage Buckets y Pol√≠ticas

**Estado:** üü° PARCIAL (buckets existen pero pol√≠ticas pueden mejorarse)

**Tareas:**

```sql
-- Verificar pol√≠ticas de Storage en Supabase Dashboard

-- Bucket: incidencias-imagenes
-- Pol√≠tica de SELECT: Todos los autenticados
CREATE POLICY "Authenticated users can view images"
ON storage.objects FOR SELECT
TO authenticated
USING (bucket_id = 'incidencias-imagenes');

-- Pol√≠tica de INSERT: Solo usuarios autenticados
CREATE POLICY "Authenticated users can upload images"
ON storage.objects FOR INSERT
TO authenticated
WITH CHECK (
  bucket_id = 'incidencias-imagenes' AND
  (storage.foldername(name))[1] IN (
    SELECT id::text FROM incidencias
  )
);

-- Pol√≠tica de DELETE: Solo Control
CREATE POLICY "Only Control can delete images"
ON storage.objects FOR DELETE
TO authenticated
USING (
  bucket_id = 'incidencias-imagenes' AND
  app.es_control()
);
```

**Checklist:**
- [ ] Revisar pol√≠ticas de Storage buckets
- [ ] Agregar l√≠mites de tama√±o de archivo (5MB im√°genes, 10MB documentos)
- [ ] Validar tipos MIME en backend
- [ ] Implementar cleanup de archivos hu√©rfanos

---

### 6. Optimizaci√≥n de Im√°genes

**Estado:** üî¥ PENDIENTE

**Problemas actuales:**
- Uso de `<img>` en lugar de `<Image />`
- Sin optimizaci√≥n autom√°tica de im√°genes
- Sin lazy loading

**Tareas:**

```typescript
// Reemplazar todos los <img> por <Image />
import Image from 'next/image';

// Antes:
<img src={url} alt="..." />

// Despu√©s:
<Image
  src={url}
  alt="..."
  width={800}
  height={600}
  placeholder="blur"
  blurDataURL="data:image/..." // Opcional: blur placeholder
  loading="lazy"
/>
```

**Configurar en next.config.js:**

```javascript
// next.config.js
module.exports = {
  images: {
    domains: [
      'your-project.supabase.co', // Supabase Storage
    ],
    formats: ['image/avif', 'image/webp'],
  },
};
```

**Checklist:**
- [ ] Reemplazar `<img>` por `<Image />` en todos los archivos
- [ ] Configurar dominios permitidos en next.config.js
- [ ] Agregar dimensiones a todas las im√°genes
- [ ] Probar que im√°genes se cargan correctamente

---

### 7. Logs y Monitoring de Producci√≥n

**Estado:** üî¥ PENDIENTE

**Recomendaciones:**

```typescript
// lib/logger.ts
type LogLevel = 'info' | 'warn' | 'error';

export function log(level: LogLevel, message: string, data?: any) {
  const timestamp = new Date().toISOString();

  // En desarrollo: console
  if (process.env.NODE_ENV === 'development') {
    console[level](`[${timestamp}] ${message}`, data);
  }

  // En producci√≥n: enviar a servicio
  if (process.env.NODE_ENV === 'production') {
    // Ejemplo con Sentry:
    // Sentry.captureMessage(message, { level, extra: data });

    // O tu propio endpoint:
    // fetch('/api/logs', {
    //   method: 'POST',
    //   body: JSON.stringify({ level, message, data, timestamp }),
    // });
  }
}

// Uso:
log('info', 'Usuario inici√≥ sesi√≥n', { userId: '123' });
log('error', 'Error cargando incidencias', { error: err.message });
```

**Servicios recomendados:**
- **Sentry** - Error tracking y performance monitoring
- **Vercel Analytics** - Si deployeas en Vercel
- **LogRocket** - Session replay y debugging
- **Datadog** - APM y logs enterprise

**Checklist:**
- [ ] Crear `lib/logger.ts`
- [ ] Reemplazar `console.log` por logger en producci√≥n
- [ ] Configurar servicio de logs (opcional pero recomendado)
- [ ] Agregar alertas para errores cr√≠ticos

---

## üí° Mejoras Recomendadas

**Prioridad:** üü¢ BAJA (nice to have, no bloqueantes)

### 1. Testing Automatizado

**Estado:** üî¥ NO EXISTE

**Configuraci√≥n b√°sica:**

```bash
# Instalar dependencias de testing
npm install -D @testing-library/react @testing-library/jest-dom jest jest-environment-jsdom
npm install -D @testing-library/user-event
```

```javascript
// jest.config.js
const nextJest = require('next/jest');

const createJestConfig = nextJest({
  dir: './',
});

const customJestConfig = {
  setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],
  moduleNameMapper: {
    '^@/(.*)$': '<rootDir>/$1',
  },
  testEnvironment: 'jest-environment-jsdom',
};

module.exports = createJestConfig(customJestConfig);
```

```javascript
// jest.setup.js
import '@testing-library/jest-dom';
```

**Tests prioritarios:**
- [ ] `lib/incidenciasService.test.ts` - Tests de queries
- [ ] `contexts/AuthContext.test.tsx` - Tests de auth
- [ ] `components/DashboardCliente.test.tsx` - Tests de UI cr√≠tica

---

### 2. Documentaci√≥n de API Interna

**Estado:** üü° PARCIAL (hay comentarios pero no documentaci√≥n formal)

```typescript
// Ejemplo de JSDoc
/**
 * Obtiene todas las incidencias seg√∫n el perfil del usuario
 *
 * @param perfil - Perfil del usuario autenticado
 * @returns Array de incidencias con datos completos
 * @throws {Error} Si no se puede conectar a la base de datos
 *
 * @example
 * ```typescript
 * const { perfil } = useAuth();
 * const incidencias = await obtenerIncidenciasPorPerfil(perfil);
 * ```
 */
export async function obtenerIncidenciasPorPerfil(
  perfil: Perfil
): Promise<Incidencia[]> {
  // ...
}
```

**Checklist:**
- [ ] Agregar JSDoc a todas las funciones p√∫blicas
- [ ] Documentar types/interfaces en `types/`
- [ ] Crear `CONTRIBUTING.md` con gu√≠as de c√≥digo
- [ ] Generar docs autom√°ticamente con TypeDoc (opcional)

---

### 3. Performance: React Query / SWR

**Estado:** üî¥ NO EXISTE (actualmente todo es fetch manual)

**Problema actual:**
- No hay cach√© de datos
- Refetch innecesarios
- No hay revalidaci√≥n autom√°tica

**Soluci√≥n con SWR:**

```bash
npm install swr
```

```typescript
// lib/hooks/useIncidencias.ts
import useSWR from 'swr';
import { obtenerIncidenciasPorPerfil } from '@/lib/incidenciasService';

export function useIncidencias() {
  const { perfil } = useAuth();

  const { data, error, isLoading, mutate } = useSWR(
    perfil ? ['incidencias', perfil.persona_id] : null,
    () => obtenerIncidenciasPorPerfil(perfil!),
    {
      revalidateOnFocus: true,
      dedupingInterval: 5000, // No refetch si pas√≥ <5s
    }
  );

  return {
    incidencias: data ?? [],
    loading: isLoading,
    error,
    refetch: mutate,
  };
}

// Uso en componente:
const { incidencias, loading, refetch } = useIncidencias();
```

**Beneficios:**
- ‚ö° Cach√© autom√°tico
- ‚ö° Revalidaci√≥n en focus
- ‚ö° Deduplicaci√≥n de requests
- ‚ö° Optimistic updates

**Checklist:**
- [ ] Instalar SWR o React Query
- [ ] Crear hooks para cada recurso (incidencias, comentarios, presupuestos)
- [ ] Migrar componentes para usar hooks
- [ ] Configurar estrategias de cach√©

---

### 4. Internacionalizaci√≥n (i18n)

**Estado:** üî¥ NO EXISTE (todo hardcoded en espa√±ol)

**Solo si necesitas multi-idioma:**

```bash
npm install next-intl
```

```typescript
// messages/es.json
{
  "dashboard": {
    "title": "Panel de Control",
    "incidencias": "Incidencias"
  }
}

// Uso:
import { useTranslations } from 'next-intl';

const t = useTranslations('dashboard');
<h1>{t('title')}</h1>
```

**Checklist:**
- [ ] Decidir si es necesario multi-idioma
- [ ] Si s√≠: Instalar next-intl
- [ ] Extraer todos los strings a archivos JSON
- [ ] Configurar idiomas soportados

---

### 5. PWA (Progressive Web App)

**Estado:** üî¥ NO EXISTE

**Para que la app sea instalable en m√≥viles:**

```bash
npm install next-pwa
```

```javascript
// next.config.js
const withPWA = require('next-pwa')({
  dest: 'public',
  register: true,
  skipWaiting: true,
});

module.exports = withPWA({
  // ... resto de config
});
```

```json
// public/manifest.json
{
  "name": "FMINCI Web",
  "short_name": "FMINCI",
  "description": "Sistema de gesti√≥n de incidencias",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#5D6D52",
  "theme_color": "#5D6D52",
  "icons": [
    {
      "src": "/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
```

**Checklist:**
- [ ] Instalar next-pwa
- [ ] Crear manifest.json
- [ ] Generar iconos (192x192, 512x512)
- [ ] Probar instalaci√≥n en m√≥vil

---

## ‚ö° Optimizaciones de Performance

**Estado:** üü° ACEPTABLE (pero puede mejorar)

### 1. Bundle Size Optimization

```bash
# Analizar bundle actual
npm install -D @next/bundle-analyzer

# next.config.js
const withBundleAnalyzer = require('@next/bundle-analyzer')({
  enabled: process.env.ANALYZE === 'true',
});

module.exports = withBundleAnalyzer({
  // ... config
});

# Ejecutar an√°lisis
ANALYZE=true npm run build
```

**Acciones:**
- [ ] Revisar dependencias grandes
- [ ] Implementar dynamic imports para rutas pesadas
- [ ] Evaluar si todas las deps son necesarias

---

### 2. Database Query Optimization

**Queries a revisar:**

```typescript
// ‚ùå MAL: Select *
const { data } = await supabase
  .from('incidencias')
  .select('*');

// ‚úÖ BIEN: Select solo lo necesario
const { data } = await supabase
  .from('incidencias')
  .select('id, num_solicitud, estado_cliente, fecha_creacion');

// ‚úÖ MEJOR: Con √≠ndices
// Crear en Supabase:
CREATE INDEX idx_incidencias_institucion_estado
ON incidencias(institucion_id, estado_cliente);
```

**Checklist:**
- [ ] Revisar todos los `.select('*')` y especificar columnas
- [ ] Crear √≠ndices en columnas frecuentemente filtradas
- [ ] Usar `.range()` para paginaci√≥n en lugar de cargar todo

---

### 3. Implementar Paginaci√≥n

**Archivos prioritarios:**
- `app/(app)/incidencias/page.tsx` - Puede tener 1000+ incidencias
- `app/(app)/control/presupuestos/page.tsx` - Puede crecer mucho

```typescript
// Ejemplo de paginaci√≥n
const ITEMS_PER_PAGE = 20;

export async function obtenerIncidenciasPaginadas(
  perfil: Perfil,
  page: number = 1
): Promise<{ data: Incidencia[]; count: number }> {
  const start = (page - 1) * ITEMS_PER_PAGE;
  const end = start + ITEMS_PER_PAGE - 1;

  const { data, error, count } = await supabase
    .from('incidencias')
    .select('*', { count: 'exact' })
    .range(start, end)
    .order('fecha_creacion', { ascending: false });

  if (error) throw error;

  return { data: data || [], count: count || 0 };
}
```

**Checklist:**
- [ ] Implementar paginaci√≥n en incidencias
- [ ] Implementar paginaci√≥n en presupuestos
- [ ] Agregar controles de navegaci√≥n (prev/next)
- [ ] Mostrar n√∫mero de p√°gina actual

---

### 4. Cach√© de Im√°genes y Assets

**Configurar en next.config.js:**

```javascript
module.exports = {
  // ... otras configs

  // Configurar headers para cach√©
  async headers() {
    return [
      {
        source: '/images/:path*',
        headers: [
          {
            key: 'Cache-Control',
            value: 'public, max-age=31536000, immutable',
          },
        ],
      },
    ];
  },
};
```

---

## ‚úÖ Checklist Pre-Producci√≥n

### Seguridad y Configuraci√≥n
- [ ] Variables de entorno configuradas correctamente
- [ ] `.env.local` no est√° en git
- [ ] RLS habilitado en todas las tablas
- [ ] Pol√≠ticas de Storage revisadas
- [ ] Service Role Key nunca expuesta en cliente

### C√≥digo y Estructura
- [ ] Fase 3 completada (comentariosService, presupuestosService)
- [ ] Fase 4 completada (chat-proveedor refactorizado)
- [ ] ErrorBoundary implementado
- [ ] Loading states en todos los componentes
- [ ] Validaci√≥n de formularios con Zod

### Performance
- [ ] Build sin errores: `npm run build`
- [ ] Bundle size analizado y optimizado
- [ ] Im√°genes optimizadas con `<Image />`
- [ ] Queries optimizadas (sin N+1)
- [ ] Paginaci√≥n implementada en listas grandes

### Testing
- [ ] Tests manuales completados para cada rol
- [ ] Flujo completo de incidencia probado
- [ ] Flujo de presupuestos probado
- [ ] Flujo de comentarios probado
- [ ] Responsive design verificado (m√≥vil/tablet/desktop)

### Monitoreo
- [ ] Error logging configurado
- [ ] Servicio de monitoring elegido (opcional)
- [ ] Alertas configuradas para errores cr√≠ticos

### Documentaci√≥n
- [ ] README.md actualizado
- [ ] `.env.example` creado
- [ ] CLAUDE.md actualizado
- [ ] MIGRACION_ROLES_NATIVOS.md completo
- [ ] ROADMAP_PRODUCCION.md (este archivo)

### Deployment
- [ ] Dominio configurado
- [ ] SSL/HTTPS habilitado
- [ ] Supabase en plan de producci√≥n (si aplica)
- [ ] Variables de entorno en plataforma de deploy
- [ ] Backup de base de datos configurado

---

## üéØ Resumen de Prioridades

### Antes de Producci√≥n (Bloqueantes)

1. **Fase 3** - Centralizar comentarios y presupuestos (4-6h)
2. **Variables de entorno** - Crear .env.example y validaci√≥n (1h)
3. **ErrorBoundary** - Manejo de errores global (2h)
4. **Loading states** - UX durante carga (2h)
5. **Validaci√≥n formularios** - Zod en formularios cr√≠ticos (3h)
6. **Optimizaci√≥n im√°genes** - Reemplazar `<img>` por `<Image />` (2h)

**Total:** ~14-16 horas de trabajo

### Despu√©s de Producci√≥n (Mejoras continuas)

1. **Fase 4** - Refactorizar chat-proveedor (6-8h)
2. **Testing** - Tests automatizados (variable)
3. **Performance** - SWR/React Query (4h)
4. **PWA** - Si se requiere app m√≥vil (3h)
5. **i18n** - Si se requiere multi-idioma (8h)

---

## üìû Soporte y Contacto

**Archivos de referencia:**
- üìÑ `CLAUDE.md` - Informaci√≥n del proyecto para Claude
- üìÑ `MIGRACION_ROLES_NATIVOS.md` - Detalles de seguridad
- üìÑ `ROADMAP_PRODUCCION.md` - Este archivo

**Comandos √∫tiles:**
```bash
# Desarrollo
npm run dev

# Build de producci√≥n
npm run build

# Verificar tipos
npm run type-check

# Linting
npm run lint

# An√°lisis de bundle
ANALYZE=true npm run build
```

---

**√öltima actualizaci√≥n:** 2025-10-02
**Pr√≥xima revisi√≥n:** Despu√©s de completar Fase 3

üöÄ **¬°√âxito con el lanzamiento a producci√≥n!**
